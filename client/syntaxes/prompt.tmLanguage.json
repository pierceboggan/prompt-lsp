{
  "name": "AI Prompt",
  "scopeName": "text.prompt",
  "patterns": [
    { "include": "#variables" },
    { "include": "#xml-tags" },
    { "include": "#markdown-headers" },
    { "include": "#strong-instructions" },
    { "include": "#medium-instructions" },
    { "include": "#weak-instructions" },
    { "include": "#injection-patterns" },
    { "include": "#persona-definitions" },
    { "include": "#safety-keywords" },
    { "include": "#code-blocks" },
    { "include": "#inline-code" },
    { "include": "#comments" }
  ],
  "repository": {
    "variables": {
      "patterns": [
        {
          "name": "variable.other.prompt",
          "match": "\\{\\{\\s*([\\w_]+)\\s*\\}\\}",
          "captures": {
            "1": { "name": "variable.parameter.prompt" }
          }
        }
      ]
    },
    "xml-tags": {
      "patterns": [
        {
          "name": "entity.name.tag.prompt",
          "match": "</?[a-z_]+>",
          "captures": {
            "0": { "name": "punctuation.definition.tag.prompt" }
          }
        }
      ]
    },
    "markdown-headers": {
      "patterns": [
        {
          "name": "markup.heading.prompt",
          "match": "^#{1,6}\\s+.+$"
        }
      ]
    },
    "strong-instructions": {
      "patterns": [
        {
          "name": "keyword.control.strong.prompt",
          "match": "\\b(never|must|always|under no circumstances|absolutely|required|mandatory|forbidden|prohibited)\\b",
          "captures": {
            "1": { "name": "keyword.control.prompt" }
          }
        }
      ]
    },
    "medium-instructions": {
      "patterns": [
        {
          "name": "keyword.other.medium.prompt",
          "match": "\\b(should|avoid|prefer|recommended|expected|generally|typically)\\b"
        }
      ]
    },
    "weak-instructions": {
      "patterns": [
        {
          "name": "comment.weak-instruction.prompt",
          "match": "\\b(try to|consider|when appropriate|if possible|might|could|may want to|optionally)\\b"
        }
      ]
    },
    "injection-patterns": {
      "patterns": [
        {
          "name": "invalid.illegal.injection.prompt",
          "match": "\\b(ignore previous|ignore all|disregard|new instructions|jailbreak|DAN mode)\\b"
        }
      ]
    },
    "persona-definitions": {
      "patterns": [
        {
          "name": "entity.name.type.persona.prompt",
          "match": "\\b(you are|act as|behave like|your role is|you're a|as an?)\\b",
          "captures": {
            "1": { "name": "keyword.other.persona.prompt" }
          }
        }
      ]
    },
    "safety-keywords": {
      "patterns": [
        {
          "name": "keyword.control.safety.prompt",
          "match": "\\b(safety|harmful|dangerous|illegal|refuse|reject|decline|inappropriate|offensive)\\b"
        }
      ]
    },
    "code-blocks": {
      "begin": "```",
      "end": "```",
      "name": "markup.fenced_code.block.prompt",
      "patterns": [
        {
          "include": "source"
        }
      ]
    },
    "inline-code": {
      "patterns": [
        {
          "name": "markup.inline.raw.string.prompt",
          "match": "`[^`]+`"
        }
      ]
    },
    "comments": {
      "patterns": [
        {
          "name": "comment.block.prompt",
          "begin": "<!--",
          "end": "-->"
        },
        {
          "name": "comment.line.prompt",
          "match": "^\\s*//.*$"
        }
      ]
    }
  }
}
